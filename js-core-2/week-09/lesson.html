
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Week 9 - AJAX, Async, Promises Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../../js-core-3/" />
    
    
    <link rel="prev" href="../week-08/lesson.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Course</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Before you start
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../others/lesson0.html">
            
                <a href="../../others/lesson0.html">
            
                    
                    Week 0 - Introduction and basic setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../house-rules.html">
            
                <a href="../../house-rules.html">
            
                    
                    House Rules
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../html-css/">
            
                <a href="../../html-css/">
            
                    
                    HTML/CSS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../html-css/week-01/lesson.html">
            
                <a href="../../html-css/week-01/lesson.html">
            
                    
                    Week 1 - Semantic HTML and CSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../html-css/week-02/lesson.html">
            
                <a href="../../html-css/week-02/lesson.html">
            
                    
                    Week 2 - Responsive Web and layout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../html-css/week-03/lesson.html">
            
                <a href="../../html-css/week-03/lesson.html">
            
                    
                    Week 3 - Design frameworks, Naming patterns and Forms
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../js-core/">
            
                <a href="../../js-core/">
            
                    
                    JavaScript I
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../js-core/week-04/lesson.html">
            
                <a href="../../js-core/week-04/lesson.html">
            
                    
                    Week 4 - Hello JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../js-core/week-05/lesson.html">
            
                <a href="../../js-core/week-05/lesson.html">
            
                    
                    Week 5 - Arrays and Objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../js-core/week-06/lesson.html">
            
                <a href="../../js-core/week-06/lesson.html">
            
                    
                    Week 6 - Debugging and more Data Structures
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../">
            
                <a href="../">
            
                    
                    JavaScript II
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../week-07/lesson.html">
            
                <a href="../week-07/lesson.html">
            
                    
                    Week 7 - In-depth Functions and Intro to DOM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../week-08/lesson.html">
            
                <a href="../week-08/lesson.html">
            
                    
                    Week 8 - DOM, Events
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.3" data-path="lesson.html">
            
                <a href="lesson.html">
            
                    
                    Week 9 - AJAX, Async, Promises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../js-core-3/">
            
                <a href="../../js-core-3/">
            
                    
                    JavaScript III
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../js-core-3/week-10/lesson.html">
            
                <a href="../../js-core-3/week-10/lesson.html">
            
                    
                    Week 10 - Good Code, TDD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../js-core-3/week-11/lesson.html">
            
                <a href="../../js-core-3/week-11/lesson.html">
            
                    
                    Week 11 - More TDD, ES6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../js-core-3/week-12/lesson.html">
            
                <a href="../../js-core-3/week-12/lesson.html">
            
                    
                    Week 12 - Recap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../node-db/">
            
                <a href="../../node-db/">
            
                    
                    Node/DB I
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../node-db/week-13/lesson.html">
            
                <a href="../../node-db/week-13/lesson.html">
            
                    
                    Week 13 - Node and Express 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../node-db/week-14/lesson.html">
            
                <a href="../../node-db/week-14/lesson.html">
            
                    
                    Week 14 - Middleware, Templating and APIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../../node-db/week-15/lesson.html">
            
                <a href="../../node-db/week-15/lesson.html">
            
                    
                    Week 15 - Advanced Node
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../node-db/">
            
                <a href="../../node-db/">
            
                    
                    Node/DB II
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../node-db/week-16/lesson.html">
            
                <a href="../../node-db/week-16/lesson.html">
            
                    
                    Week 16 - Basic SQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../node-db/week-17/lesson.html">
            
                <a href="../../node-db/week-17/lesson.html">
            
                    
                    Week 17 - SQL with Node
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../node-db/week-18/lesson.html">
            
                <a href="../../node-db/week-18/lesson.html">
            
                    
                    Week 18 - Data Integrity & Analytics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../react/">
            
                <a href="../../react/">
            
                    
                    React
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../react/week-19/lesson.html">
            
                <a href="../../react/week-19/lesson.html">
            
                    
                    Week 19 - React 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../../react/week-20/lesson.html">
            
                <a href="../../react/week-20/lesson.html">
            
                    
                    Week 20 - State
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../../react/week-21/lesson.html">
            
                <a href="../../react/week-21/lesson.html">
            
                    
                    Week 21 - React-router & Recap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Useful informations</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../PRACTICES.html">
            
                <a href="../../PRACTICES.html">
            
                    
                    Coding Standards and Best Practices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../others/making-a-pull-request.html">
            
                <a href="../../others/making-a-pull-request.html">
            
                    
                    Making a Pull Request
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Workshops and other resources</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../others/coding-101.html">
            
                <a href="../../others/coding-101.html">
            
                    
                    Coding 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../html-css/compile-scss-instructions.html">
            
                <a href="../../html-css/compile-scss-instructions.html">
            
                    
                    Compiling SCSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../../node-db/week-13/workshop.html">
            
                <a href="../../node-db/week-13/workshop.html">
            
                    
                    Express Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../../node-db/week-15/workshop.html">
            
                <a href="../../node-db/week-15/workshop.html">
            
                    
                    Hotel Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../../others/aws-workshop-2.html">
            
                <a href="../../others/aws-workshop-2.html">
            
                    
                    AWS - DynamoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" >
            
                <a target="_blank" href="https://github.com/Thomas-Stewart/syllabus/tree/master/java">
            
                    
                    Java module
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">For Mentors</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../CONTRIBUTING.html">
            
                <a href="../../CONTRIBUTING.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../others/lesson-template.html">
            
                <a href="../../others/lesson-template.html">
            
                    
                    Lesson Template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../../html-css/mentor-guide.html">
            
                <a href="../../html-css/mentor-guide.html">
            
                    
                    HTML/CSS Mentors guide
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Week 9 - AJAX, Async, Promises</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="javascript-core-5">JavaScript Core 5</h1>
<p><img src="https://img.shields.io/badge/status-draft-darkred.svg" alt=""></p>
<p><strong>What will we learn today?</strong></p>
<ul>
<li><a href="#callbacks-and-asynchronous">Callbacks and Asynchronous Functions</a></li>
<li><a href="#promises">Promises</a></li>
<li><a href="#ajax">AJAX</a></li>
</ul>
<h2 id="callbacks-and-asynchronous-functions">Callbacks and Asynchronous Functions</h2>
<p>We have already seen callback functions - in the Array methods <code>forEach</code>, <code>map</code>, <code>filter</code> etc. They are functions that are passed as parameter to another function.</p>
<p>Callbacks have another purpose as <strong>asynchronous</strong> functions. For these type of functions, the callback is called once another function has completed. This allows you to run some other code while you&apos;re waiting for something to finish.</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">finished</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;The task has finished&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">thingThatTakesALongTime</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//... Task that takes a long time to complete</span>

  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// This is where the &apos;console.log&apos; happens</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// Pass the function to &apos;thingThatTakesALongTime&apos; just like a normal variable</span>
<span class="token function">thingThatTakesALongTime</span><span class="token punctuation">(</span>finished<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>So far all of the callbacks you have been using have been <strong>synchronous</strong>. This means your code is executed one line at a time, at the same time, in order. Asynchronous code is not executed in order, and can run at any time, in any order.</p>
<p>An example of this in real life, are phone calls and text messages.</p>
<ul>
<li>Phone calls are <code>synchronous</code> because you can&apos;t (really) do anything while the
other person is speaking. You are always waiting for your turn to respond</li>
<li>Text messages are <code>asynchronous</code>. When you send a text, you can go away and do
something else, until the other person responds.</li>
</ul>
<p>A simple example of an asynchronous function is <code>setTimeout</code>. This allows you to run a function after a
given time period. The first argument is the function you want to run, the
second argument is the <code>delay</code> (in milliseconds)</p>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// Separate function definition</span>
<span class="token keyword">function</span> <span class="token function">myCallbackFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>myCallbackFunction<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Inline function</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Goodbye world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p><strong>Exercises</strong></p>
<ul>
<li>Using setTimeout, change the background color of the page after 5 seconds (5000 milliseconds).</li>
<li>Update your code to make the color change <em>every</em> 5 seconds to something different. Hint: try searching for <code>setInterval</code>.
<img src="http://g.recordit.co/g2EqBccNzh.gif" alt=""></li>
</ul>
</blockquote>
<h2 id="promises">Promises</h2>
<p>Promises are a new(ish) feature of JavaScript. They allow for
writing easier to understand code when dealing with asynchronous functions.
<img src="http://exploringjs.com/es6/images/promises----promise_states_simple.jpg" alt=""></p>
<p>Promises are more &quot;abstract&quot; than anything we have covered so far. They are a data structure that represents some result that is going to happen in the future. The result starts off as being unknown (pending) as the code has not completed yet. The result can then move to be successful (fulfilled) or failed (rejected).</p>
<p>The API is very simple. When you have a Promise, you can attach a <code>.then</code>
method with a callback and/or a <code>.catch</code> method with a callback. If the promise is successful, then the function
in the <code>.then</code> callback is called. If it fails, then the <code>.catch</code> callback is
called.</p>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// Call a function that returns a Promise</span>
<span class="token keyword">var</span> myPromise <span class="token operator">=</span> <span class="token function">functionThatReturnsAPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

myPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;success: &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

myPromise<span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fail:&quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The <code>.then</code> and <code>.catch</code> methods can be chained, like with Array methods:</p>
<pre class="language-"><code class="lang-js">myPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;success: &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fail: &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>You can even return a Promise from within a <code>.then</code> callback, and keep chaining on more <code>.then</code> callbacks. This allows you to process part of the value and keep passing it along the chain:</p>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// myPromise resolves with a value of 50</span>
myPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// Logs: 50</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Returns a new Promise</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// Logs: 100</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>We will look at some common functions that return a Promise in a bit, but you can also create your own Promise. This example shows a Promise being &quot;resolved&quot; (successful):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">var</span> myPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Do some work in this function</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Resolves the Promise with the value 100</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This example shows a Promise being &quot;rejected&quot; (failed):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">var</span> myPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Do some work in this function</span>
  <span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// Rejects the Promise with the value 50</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p><strong>Exercises</strong></p>
<p>Complete the exercises in <a href="https://codepen.io/fortythieves/pen/QOYgWb?editors=1010" target="_blank">this CodePen</a></p>
</blockquote>
<h2 id="ajax">AJAX</h2>
<h3 id="whats-a-server">What&apos;s a server?</h3>
<p>A device or program that <strong>provides functionality to other programs or
devices</strong>. There are database servers, mail servers, game servers, etc. The vast majority of these servers are accessed over the internet.</p>
<p>They can take the form of industrial server farms that provide a service to
millions of users (used by Facebook, Google, etc.), to personal servers for
storing your files.</p>
<p>The server communicates with <strong>clients</strong>. Clients can be a web browser, a Slack
app, your phone, etc.</p>
<p>Client&#x2013;server systems use the <strong>request&#x2013;response model</strong>: a client sends a
request to the server, which performs some action and sends a response back to
the client, typically with a result or acknowledgement.</p>
<blockquote>
<p>An example: We can use the Slack app (the client) to put our messages or
pictures on Slack. The content is stored on the Slack servers and other
clients can then also access the pictures.</p>
</blockquote>
<h3 id="http-requests">HTTP requests</h3>
<p>A server stores the data, and the client (other programs or computers) requests
data or sends some of its own. But how do they talk to each other?</p>
<p><strong>For the client and the server to communicate they need an established language
(a protocol)</strong>. Which is what HTTP (Hypertext Transfer Protocol) is for. It
defines the methods you can use to communicate with a server and indicate your
desired actions on the resources of the server.</p>
<p>There are two main types of requests: <code>GET</code> and <code>POST</code>.</p>
<blockquote>
<p>With a <strong>GET request</strong> you can ask for specified resource (e.g. show me that
Slack photo).</p>
<p>With a <strong>POST request</strong> you can send content to the server to be appended to
the web resource (e.g. post a photo on Slack).</p>
</blockquote>
<p>HTTP is the language of the internet. In our case we&apos;re using JavaScript, but
you can send HTTP requests with other languages as well.</p>
<h3 id="ajax-asynchronous-javascript-and-xml">AJAX (Asynchronous JavaScript And XML)</h3>
<p>AJAX is a technique for implementing client-server communication in the browser. The word is a bit of a misnomer as generally we don&apos;t use XML any more, but it&apos;s still commonly used to describe this technique.</p>
<p><img src="https://www.w3schools.com/xml/ajax.gif" alt="AJAX Diagram" title="AJAX Diagram"></p>
<p>Ajax just uses a combination of:</p>
<blockquote>
<ul>
<li>A browser built-in XMLHttpRequest object (to request data from a web server)</li>
<li>JavaScript and HTML DOM (to display or use the data)</li>
</ul>
</blockquote>
<p>Ajax works behind the scenes, helping the webpage communicate with the server
(with GET and POST requests).</p>
<blockquote>
<p>client --&gt; GET request --&gt; server returns data to client</p>
<p>client --&gt; POST request (with body content) --&gt; server updates data with body content</p>
</blockquote>
<p>Typically, the server holds the data, and only sends it to the client (web page) when there&apos;s a
request. Ajax requests are sent after the page has loaded, usually in response to an action by the user. For example when the user clicks a button, some JavaScript will trigger an Ajax request to fetch data.</p>
<h3 id="why-ajax">Why Ajax?</h3>
<p>There are other ways you can write HTTP requests, such as using Web sockets.
What&apos;s great about Ajax is that it makes it look like magic! The server and the
client communicate effortlessly:</p>
<blockquote>
<p>Update a web page without reloading the page Request data from a server -
after the page has loaded Receive data from a server - after the page has
loaded Send data to a server - in the background</p>
</blockquote>
<h2 id="fetch">Fetch</h2>
<p><code>fetch</code> is a way of creating HTTP requests in JavaScript. It uses of the Promise API.</p>
<p>This example shows a GET request that fetches some data and logs it out:</p>
<pre class="language-"><code class="lang-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&apos;http://www.mocky.io/v2/5a22e20a2f0000c00d5ec665&apos;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Necessary line to parse the JSON (we&apos;ll cover this </span>
    <span class="token comment" spellcheck="true">// in more detail in upcoming weeks)</span>
    <span class="token comment" spellcheck="true">// Returns another Promise</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Do something with the json response object</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Logs: &apos;Hello world!&apos;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>To create a POST request, you can pass an options object as the second argument to <code>fetch</code> with the <code>method</code> property set to <code>&apos;POST&apos;</code>. Any data that you want to send should be set as the <code>body</code> property.</p>
<p>Here is an example showing a POST request:</p>
<pre class="language-"><code class="lang-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&apos;http://www.mocky.io/v2/5a22e20a2f0000c00d5ec665&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">&apos;POST&apos;</span><span class="token punctuation">,</span>
  body<span class="token punctuation">:</span> <span class="token string">&apos;I am sending a POST request!&apos;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Typically it is more useful to servers if they receive structured data like JSON. We will cover JSON more in upcoming weeks, but for now it is sufficient to know that it is a way of structuring data to send over the internet.</p>
<p>To send a POST request with JSON you need to add a little more information to the request - a <code>headers</code> property must be included which marks the request as contains JSON. This will give the server a hint that it needs to parse JSON in the request.</p>
<p>Here is an example showing a POST request with JSON:</p>
<pre class="language-"><code class="lang-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&apos;http://www.mocky.io/v2/5a22e20a2f0000c00d5ec665&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">&apos;POST&apos;</span><span class="token punctuation">,</span>
  headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Mark the request as containing JSON</span>
    <span class="token string">&apos;Content-Type&apos;</span><span class="token punctuation">:</span> <span class="token string">&apos;application/json&apos;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  body<span class="token punctuation">:</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// Converts objects to JSON</span>
    data<span class="token punctuation">:</span> <span class="token string">&apos;I am sending a POST request with JSON&apos;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<blockquote>
<p><strong>Exercise</strong></p>
<p>Everyone should organise in pairs to write a very simple chat application. One person will write the code to <strong>send data (with a POST request)</strong> to a server and one to <strong>fetch it (with a GET request)</strong>.</p>
<ul>
<li>Start with <a href="https://codepen.io/fortythieves/pen/mqvmYQ?editors=1010" target="_blank">this CodePen project</a></li>
<li>Create a function that makes a POST request that sends a new chat message to the server</li>
<li>Create a function that makes a GET request that fetches all messages from the server</li>
<li>Wire up the <code>#fetch-messages</code> button so that it makes the GET request then inserts the chat messages into the <code>#message-list</code> element</li>
<li>Wire up the <code>#create-message</code> button so that it makes the POST request
The URL to send requests to is <a href="https://luxuriant-scorpion.glitch.me/chat" target="_blank">https://luxuriant-scorpion.glitch.me/chat</a> (for both GET and POST). Note that it is a JSON API, so you&apos;ll need the <code>response.json()</code> method to parse responses and the <code>Content-Type</code> header for POST requests.</li>
</ul>
</blockquote>
<h2 id="resources">Resources</h2>
<ol>
<li><a href="http://javascriptissexy.com/understand-javascript-callback-functions-and-use-them/" target="_blank">Understand JavaScript Callback Functions and Use Them</a></li>
<li><a href="https://medium.freecodecamp.com/javascript-callbacks-explained-using-minions-da272f4d9bcd#.83dht6ta8" target="_blank">JavaScript Callbacks Explained Using Minions</a></li>
<li><a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank">MDN Promise docs</a></li>
<li><a href="https://www.promisejs.org/" target="_blank">promisejs.org</a></li>
<li><a href="https://developers.google.com/web/fundamentals/getting-started/primers/promises" target="_blank">Google Developer article on Promises</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started" target="_blank">MDN AJAX docs</a></li>
<li><a href="https://developer.mozilla.org/en/docs/Web/API/Fetch_API" target="_blank">MDN fetch API</a></li>
<li><a href="https://davidwalsh.name/fetch" target="_blank">David Walsh blog post</a></li>
</ol>
<h1 id="homework">Homework</h1>
<ol>
<li>Please Make sure you have finished the bookshelf project, including the
stretch goals</li>
<li>Work in pairs to do <em>Weather App Exercise</em> and send the link to your
repository on <em>your trello card</em>.</li>
</ol>
<h2 id="weather-app">Weather App</h2>
<p>Working in pairs, build a web app displaying the 5 day weather forecast for a
location of your choice. It is up to you how you divide the work, you can each
do a bit or have one person focus on UI / UX and another on JS code.</p>
<p>One of you should create a repository on github and make sure the other team
member has access to push to it.
<a href="https://codeyourfuture.github.io/syllabus-master/others/making-a-pull-request.html" target="_blank">Use this guide to help you</a>.</p>
<p>Read and use the
<a href="http://openweathermap.org/api" target="_blank">OpenWeatherMap weather forecast API</a> to retrieve
the current 5 day weather forecast. Use <code>fetch</code> with this API key in your code:
<code>33fb7454eb75c6a062a86f7f0ee2695a</code>
(<a href="http://openweathermap.org/current" target="_blank">more examples</a>.)</p>
<ul>
<li><p>Create context document as a <code>README.md</code> file which includes:</p>
<ul>
<li><strong>Brief</strong> The problem you are trying to solve</li>
<li><strong>Core Functionality</strong> Functionality your app does</li>
<li><strong>Research</strong> you did for making the app - could be just links or
descriptions to any sites or apps that do tacke this problem already</li>
<li><strong>Target Audience</strong> who will be using your app</li>
<li>Any other documentation relevant to running the app - details the
contribution of each student - explains current functionality as well as any
fixes you would add if you had more time</li>
</ul>
</li>
<li><p>Make sure your project tackles:</p>
<ul>
<li><strong>Visual appeal</strong> A well thought out, visually appealling web page</li>
<li><strong>Responsive</strong> design that works well with different screen widths and on
mobile devices</li>
<li><strong>Good Code</strong> Well named variable names and functions and short and concise
functions with a clear purpose</li>
</ul>
</li>
</ul>
<p><strong>Stretch goals</strong></p>
<ul>
<li>Allow user to input or select other locations for the weather forecast</li>
<li>Add any functionality you think would be usefull to the users of your app</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../week-08/lesson.html" class="navigation navigation-prev " aria-label="Previous page: Week 8 - DOM, Events">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../../js-core-3/" class="navigation navigation-next " aria-label="Next page: JavaScript III">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Week 9 - AJAX, Async, Promises","level":"1.5.3","depth":2,"next":{"title":"JavaScript III","level":"1.6","depth":1,"path":"js-core-3/index.md","ref":"js-core-3/index.md","articles":[{"title":"Week 10 - Good Code, TDD","level":"1.6.1","depth":2,"path":"js-core-3/week-10/lesson.md","ref":"js-core-3/week-10/lesson.md","articles":[]},{"title":"Week 11 - More TDD, ES6","level":"1.6.2","depth":2,"path":"js-core-3/week-11/lesson.md","ref":"js-core-3/week-11/lesson.md","articles":[]},{"title":"Week 12 - Recap","level":"1.6.3","depth":2,"path":"js-core-3/week-12/lesson.md","ref":"js-core-3/week-12/lesson.md","articles":[]}]},"previous":{"title":"Week 8 - DOM, Events","level":"1.5.2","depth":2,"path":"js-core-2/week-08/lesson.md","ref":"js-core-2/week-08/lesson.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["prism","-highlight","todo","scripts"],"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-tomorrow.css"]},"scripts":{"files":["./checkboxRemember.js"]},"todo":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"js-core-2/week-09/lesson.md","mtime":"2018-02-16T23:07:10.322Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-02-16T23:08:53.241Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-scripts/c7a8b0876428f8ec3c1b5735174e535d-checkboxRemember.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

